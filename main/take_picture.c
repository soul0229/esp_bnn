/**
 * This example takes a picture every 5s and print its size on serial monitor.
 */

// =============================== SETUP ======================================

// 1. Board setup (Uncomment):
// #define BOARD_WROVER_KIT
// #define BOARD_ESP32CAM_AITHINKER
#define BOARD_ESP32S3_WROOM

/**
 * 2. Kconfig setup
 *
 * If you have a Kconfig file, copy the content from
 *  https://github.com/espressif/esp32-camera/blob/master/Kconfig into it.
 * In case you haven't, copy and paste this Kconfig file inside the src directory.
 * This Kconfig file has definitions that allows more control over the camera and
 * how it will be initialized.
 */

/**
 * 3. Enable PSRAM on sdkconfig:
 *
 * CONFIG_ESP32_SPIRAM_SUPPORT=y
 *
 * More info on
 * https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/kconfig.html#config-esp32-spiram-support
 */

// ================================ CODE ======================================

#include <esp_log.h>
#include <esp_system.h>
#include <nvs_flash.h>
#include <sys/param.h>
#include <string.h>

#include "freertos/FreeRTOS.h"
#include "freertos/task.h"
#include "sd_mount.h"
#include <stdio.h>
#include "loadNet.h"
#include "core.h"
#include "utils.h"
#include "resnet.h"

// support IDF 5.x
#ifndef portTICK_RATE_MS
#define portTICK_RATE_MS portTICK_PERIOD_MS
#endif
#include "esp_camera.h"
#include "init_camera.h"

static const char *TAG = "example:take_picture";
extern global_data gd;
uint8_t data1[1][3][32][32] = {
	{
		{
			{ 16,  18,  21,  20,  18,  19,  19,  18,  20,  20,  45,  59,  36,  29,  28,  24,  28,  30,  32,  34,  36,  36,  34,  32,  32,  32,  27,  32,  39,  41,  38,  41, },
			{ 17,  18,  21,  20,  18,  19,  19,  18,  18,  25,  102,  150,  79,  30,  31,  28,  33,  36,  37,  36,  35,  34,  34,  35,  33,  35,  30,  30,  27,  33,  43,  39, },
			{ 17,  18,  21,  20,  18,  20,  20,  18,  20,  33,  130,  167,  130,  52,  32,  34,  33,  35,  38,  38,  37,  35,  36,  36,  36,  30,  28,  33,  31,  30,  35,  38, },
			{ 18,  19,  21,  20,  19,  19,  20,  18,  18,  38,  149,  178,  147,  91,  41,  38,  34,  34,  37,  37,  37,  37,  35,  34,  32,  36,  35,  27,  26,  30,  28,  35, },
			{ 20,  20,  22,  21,  18,  20,  20,  18,  19,  47,  178,  208,  166,  116,  60,  36,  39,  38,  37,  37,  37,  36,  36,  35,  35,  35,  30,  38,  34,  28,  24,  26, },
			{ 20,  21,  22,  21,  19,  20,  20,  18,  18,  57,  185,  215,  187,  138,  83,  38,  36,  37,  39,  40,  39,  37,  36,  36,  37,  34,  50,  100,  70,  30,  28,  27, },
			{ 21,  22,  23,  22,  19,  21,  20,  18,  15,  55,  183,  225,  190,  156,  109,  57,  39,  39,  40,  40,  41,  39,  37,  36,  34,  62,  105,  139,  67,  25,  28,  25, },
			{ 22,  22,  23,  22,  20,  21,  21,  19,  22,  53,  188,  220,  199,  157,  122,  90,  54,  45,  37,  34,  37,  39,  38,  36,  66,  110,  148,  135,  44,  27,  27,  26, },
			{ 23,  19,  23,  21,  19,  24,  22,  21,  18,  70,  190,  204,  201,  165,  117,  102,  83,  64,  35,  36,  47,  60,  58,  73,  124,  143,  187,  108,  25,  30,  30,  25, },
			{ 24,  20,  24,  22,  19,  24,  21,  20,  23,  88,  176,  198,  177,  148,  134,  115,  101,  80,  55,  65,  89,  77,  90,  118,  141,  170,  188,  82,  31,  30,  26,  27, },
			{ 25,  20,  24,  22,  21,  25,  21,  20,  20,  66,  155,  173,  141,  116,  122,  123,  119,  109,  78,  80,  92,  91,  93,  129,  159,  187,  166,  52,  32,  31,  25,  29, },
			{ 25,  20,  24,  22,  21,  26,  22,  20,  25,  62,  137,  135,  123,  126,  117,  114,  126,  122,  99,  104,  106,  118,  102,  138,  178,  192,  134,  40,  29,  30,  26,  28, },
			{ 24,  19,  23,  24,  22,  26,  22,  20,  38,  94,  120,  114,  125,  124,  119,  106,  131,  126,  109,  117,  120,  118,  123,  140,  175,  178,  99,  35,  30,  29,  29,  26, },
			{ 24,  18,  25,  24,  22,  26,  21,  18,  52,  105,  113,  113,  140,  142,  158,  104,  150,  149,  92,  111,  140,  115,  120,  126,  152,  150,  72,  28,  32,  26,  27,  28, },
			{ 23,  18,  24,  24,  25,  29,  22,  17,  61,  104,  86,  115,  160,  136,  142,  175,  189,  159,  126,  163,  136,  103,  110,  106,  137,  120,  53,  30,  33,  27,  25,  26, },
			{ 22,  18,  22,  22,  26,  30,  23,  17,  61,  91,  75,  167,  188,  142,  108,  193,  216,  173,  162,  181,  142,  134,  119,  112,  125,  89,  30,  31,  27,  29,  24,  29, },
			{ 19,  20,  22,  22,  26,  25,  18,  19,  47,  67,  98,  147,  175,  141,  146,  172,  205,  169,  160,  199,  215,  173,  149,  134,  105,  69,  28,  28,  22,  24,  29,  33, },
			{ 22,  21,  19,  18,  23,  26,  21,  19,  42,  95,  127,  134,  171,  167,  140,  132,  185,  170,  155,  207,  169,  109,  133,  129,  97,  77,  26,  13,  20,  26,  27,  32, },
			{ 19,  20,  21,  22,  24,  24,  21,  25,  60,  108,  125,  142,  156,  177,  184,  111,  154,  163,  157,  149,  143,  127,  166,  163,  83,  65,  22,  16,  21,  27,  29,  35, },
			{ 22,  17,  17,  22,  27,  26,  26,  31,  50,  84,  94,  121,  145,  170,  158,  99,  131,  160,  144,  113,  166,  165,  169,  148,  70,  53,  23,  23,  25,  24,  29,  32, },
			{ 18,  16,  19,  22,  25,  23,  23,  29,  59,  65,  108,  136,  152,  177,  158,  106,  115,  157,  124,  103,  183,  171,  152,  110,  63,  46,  23,  20,  26,  26,  28,  31, },
			{ 18,  18,  18,  19,  27,  37,  45,  52,  87,  97,  140,  172,  164,  155,  157,  123,  101,  135,  100,  119,  162,  147,  132,  107,  68,  34,  19,  24,  25,  27,  30,  33, },
			{ 17,  16,  20,  29,  40,  41,  34,  29,  86,  109,  130,  179,  166,  142,  152,  172,  135,  142,  109,  152,  170,  142,  90,  92,  70,  27,  21,  29,  24,  24,  27,  30, },
			{ 19,  19,  28,  36,  36,  28,  26,  36,  89,  127,  103,  170,  175,  152,  164,  234,  170,  128,  203,  153,  126,  129,  95,  61,  52,  26,  22,  24,  26,  27,  23,  33, },
			{ 18,  26,  32,  34,  30,  31,  34,  42,  71,  139,  108,  122,  165,  155,  198,  234,  173,  187,  242,  147,  134,  139,  116,  69,  56,  28,  21,  27,  24,  24,  30,  29, },
			{ 26,  28,  26,  28,  30,  32,  36,  36,  61,  122,  145,  102,  118,  154,  185,  221,  216,  220,  211,  168,  148,  136,  105,  94,  58,  30,  25,  24,  25,  28,  22,  29, },
			{ 21,  22,  20,  25,  32,  37,  36,  31,  50,  94,  145,  140,  123,  152,  207,  229,  242,  212,  166,  133,  121,  106,  123,  102,  48,  37,  27,  25,  27,  26,  25,  29, },
			{ 17,  19,  21,  25,  32,  37,  28,  37,  67,  74,  111,  162,  151,  140,  175,  210,  215,  200,  151,  120,  127,  135,  135,  72,  32,  37,  32,  29,  25,  23,  29,  29, },
			{ 18,  19,  20,  24,  28,  31,  25,  69,  79,  55,  82,  137,  155,  158,  158,  158,  156,  147,  141,  149,  144,  132,  98,  47,  28,  28,  38,  34,  27,  25,  25,  29, },
			{ 19,  16,  16,  25,  26,  25,  30,  99,  97,  56,  79,  122,  144,  158,  169,  149,  135,  131,  148,  135,  114,  92,  72,  44,  27,  23,  31,  37,  33,  24,  27,  28, },
			{ 18,  15,  18,  25,  26,  19,  36,  98,  130,  70,  59,  94,  135,  154,  160,  166,  155,  149,  128,  102,  88,  79,  71,  60,  25,  24,  22,  36,  37,  24,  29,  27, },
			{ 15,  16,  19,  21,  24,  20,  48,  92,  132,  114,  76,  85,  101,  138,  156,  148,  140,  121,  100,  77,  75,  88,  113,  78,  23,  27,  26,  28,  33,  28,  24,  27, },
		},
		{
			{ 17,  19,  20,  20,  18,  19,  20,  17,  17,  13,  35,  49,  26,  22,  25,  21,  23,  23,  25,  27,  29,  29,  27,  25,  25,  25,  22,  27,  34,  36,  34,  37, },
			{ 18,  19,  20,  20,  18,  19,  20,  17,  15,  18,  92,  137,  69,  23,  26,  25,  29,  29,  30,  29,  28,  27,  27,  28,  26,  28,  25,  25,  22,  28,  39,  35, },
			{ 18,  19,  20,  20,  18,  20,  21,  17,  17,  26,  117,  154,  117,  43,  25,  29,  29,  31,  31,  31,  30,  28,  27,  27,  29,  23,  21,  26,  26,  25,  30,  33, },
			{ 19,  20,  20,  20,  19,  20,  21,  17,  15,  31,  136,  164,  133,  78,  32,  31,  30,  30,  30,  30,  30,  30,  26,  25,  25,  29,  28,  20,  21,  25,  23,  30, },
			{ 19,  19,  21,  21,  19,  21,  21,  19,  16,  40,  165,  191,  149,  102,  47,  27,  32,  31,  30,  30,  28,  27,  27,  26,  26,  26,  23,  31,  27,  21,  19,  21, },
			{ 19,  20,  21,  21,  20,  21,  22,  19,  15,  48,  171,  197,  169,  120,  68,  25,  27,  30,  32,  33,  30,  28,  27,  27,  28,  25,  41,  93,  63,  23,  23,  22, },
			{ 20,  21,  22,  22,  20,  22,  22,  19,  12,  46,  169,  207,  170,  136,  92,  44,  30,  32,  31,  31,  30,  28,  27,  26,  24,  53,  96,  130,  60,  18,  23,  20, },
			{ 21,  21,  22,  22,  21,  22,  23,  20,  19,  44,  171,  200,  177,  137,  103,  75,  43,  38,  28,  25,  26,  29,  28,  26,  56,  100,  137,  126,  37,  20,  22,  21, },
			{ 22,  18,  22,  21,  20,  25,  23,  20,  13,  61,  173,  184,  179,  145,  99,  88,  72,  55,  24,  25,  34,  47,  45,  60,  111,  133,  177,  99,  18,  23,  25,  20, },
			{ 23,  19,  23,  22,  20,  25,  22,  19,  18,  78,  159,  179,  155,  129,  116,  98,  91,  71,  44,  55,  76,  64,  77,  105,  128,  157,  178,  73,  22,  23,  21,  22, },
			{ 24,  19,  23,  22,  21,  25,  22,  19,  13,  56,  139,  154,  119,  97,  104,  109,  106,  99,  65,  67,  77,  77,  79,  115,  145,  174,  156,  43,  23,  24,  20,  24, },
			{ 24,  19,  23,  22,  21,  26,  23,  19,  18,  52,  121,  116,  104,  107,  101,  100,  113,  109,  86,  91,  92,  104,  88,  124,  164,  179,  121,  31,  22,  26,  21,  23, },
			{ 25,  18,  22,  21,  22,  26,  21,  17,  31,  84,  104,  97,  108,  107,  106,  94,  117,  112,  95,  103,  103,  101,  106,  123,  161,  165,  86,  26,  23,  24,  24,  23, },
			{ 25,  19,  22,  21,  22,  26,  20,  15,  45,  95,  97,  96,  123,  127,  147,  92,  136,  135,  78,  97,  123,  98,  103,  109,  138,  138,  59,  19,  25,  21,  24,  25, },
			{ 24,  19,  21,  21,  22,  26,  19,  12,  52,  91,  70,  98,  145,  123,  134,  166,  177,  145,  109,  146,  118,  85,  92,  90,  123,  108,  40,  21,  26,  22,  22,  25, },
			{ 23,  17,  21,  22,  23,  27,  20,  12,  52,  78,  59,  151,  173,  127,  97,  182,  202,  157,  146,  165,  126,  116,  101,  96,  111,  77,  21,  24,  22,  26,  21,  26, },
			{ 18,  19,  21,  23,  25,  24,  17,  16,  40,  57,  84,  131,  160,  125,  130,  156,  186,  152,  143,  184,  200,  158,  134,  118,  93,  61,  24,  25,  19,  21,  24,  25, },
			{ 21,  20,  20,  19,  24,  27,  20,  16,  35,  85,  113,  118,  154,  149,  123,  112,  163,  149,  137,  191,  154,  94,  118,  113,  85,  69,  22,  13,  20,  23,  19,  22, },
			{ 18,  19,  22,  23,  25,  25,  20,  20,  51,  98,  111,  126,  138,  157,  164,  89,  130,  139,  135,  129,  125,  110,  149,  145,  69,  56,  18,  13,  21,  24,  24,  28, },
			{ 21,  16,  18,  23,  28,  27,  23,  26,  41,  71,  80,  104,  124,  149,  136,  75,  103,  132,  120,  91,  145,  144,  150,  130,  55,  42,  16,  20,  22,  21,  24,  25, },
			{ 19,  17,  20,  23,  26,  24,  20,  24,  50,  52,  91,  118,  131,  154,  133,  80,  85,  127,  97,  77,  158,  148,  130,  90,  45,  35,  16,  17,  23,  23,  24,  24, },
			{ 19,  19,  19,  20,  28,  38,  42,  47,  78,  84,  123,  154,  142,  132,  135,  98,  71,  105,  73,  93,  137,  124,  110,  88,  50,  23,  11,  19,  22,  24,  26,  26, },
			{ 16,  15,  21,  30,  41,  42,  31,  24,  77,  96,  116,  161,  147,  120,  131,  150,  107,  114,  83,  127,  147,  120,  70,  75,  55,  16,  13,  24,  21,  21,  23,  26, },
			{ 18,  18,  27,  37,  37,  27,  22,  31,  79,  116,  88,  153,  157,  134,  145,  213,  145,  103,  181,  130,  104,  110,  78,  46,  41,  17,  17,  19,  23,  24,  18,  29, },
			{ 14,  25,  31,  33,  29,  30,  30,  37,  63,  128,  95,  108,  151,  139,  182,  217,  154,  168,  223,  128,  116,  123,  104,  59,  49,  23,  16,  24,  21,  21,  27,  26, },
			{ 22,  24,  25,  27,  29,  31,  32,  31,  53,  113,  132,  89,  104,  140,  171,  208,  199,  203,  194,  151,  131,  124,  95,  87,  54,  27,  22,  21,  22,  25,  19,  26, },
			{ 17,  18,  19,  24,  31,  36,  32,  26,  42,  85,  132,  127,  109,  138,  193,  215,  228,  197,  152,  119,  107,  96,  115,  98,  45,  34,  24,  22,  22,  21,  22,  26, },
			{ 13,  18,  20,  24,  31,  36,  24,  32,  58,  63,  98,  148,  137,  126,  159,  196,  202,  187,  136,  105,  113,  125,  128,  69,  32,  36,  29,  26,  20,  18,  26,  26, },
			{ 17,  18,  19,  25,  27,  30,  22,  64,  70,  44,  67,  120,  139,  142,  140,  142,  142,  133,  124,  132,  129,  119,  91,  44,  27,  27,  34,  29,  19,  20,  22,  26, },
			{ 18,  15,  17,  26,  25,  22,  25,  92,  86,  43,  62,  104,  126,  139,  150,  132,  119,  117,  130,  116,  97,  79,  63,  41,  26,  22,  25,  32,  25,  19,  22,  25, },
			{ 19,  16,  19,  26,  26,  16,  31,  89,  117,  56,  41,  74,  113,  132,  138,  147,  138,  132,  109,  82,  69,  64,  61,  55,  21,  23,  16,  27,  29,  19,  25,  25, },
			{ 16,  17,  20,  22,  24,  17,  44,  83,  119,  97,  58,  66,  77,  115,  133,  127,  121,  104,  78,  57,  55,  73,  102,  73,  19,  23,  20,  19,  25,  23,  20,  25, },
		},
		{
			{ 12,  13,  15,  12,  10,  11,  15,  13,  12,  7,  26,  39,  17,  14,  18,  14,  17,  15,  17,  19,  21,  21,  21,  19,  19,  19,  18,  23,  30,  32,  31,  34, },
			{ 13,  13,  15,  12,  10,  11,  15,  13,  10,  12,  83,  128,  60,  13,  20,  18,  20,  21,  22,  21,  20,  19,  21,  22,  20,  22,  21,  21,  18,  24,  36,  32, },
			{ 13,  13,  15,  12,  10,  12,  16,  13,  12,  18,  109,  145,  108,  34,  19,  23,  20,  22,  23,  23,  22,  20,  20,  20,  23,  17,  15,  20,  22,  21,  26,  29, },
			{ 14,  14,  15,  12,  11,  12,  16,  12,  10,  23,  128,  155,  124,  69,  25,  25,  21,  21,  22,  22,  22,  22,  19,  18,  19,  23,  22,  14,  17,  21,  19,  26, },
			{ 15,  14,  16,  13,  11,  13,  16,  13,  11,  32,  156,  181,  139,  93,  41,  20,  26,  25,  22,  22,  21,  20,  20,  19,  19,  19,  17,  25,  21,  15,  15,  17, },
			{ 15,  15,  16,  13,  12,  13,  17,  13,  10,  41,  162,  187,  159,  110,  61,  19,  22,  24,  24,  25,  23,  21,  20,  20,  21,  18,  36,  87,  57,  17,  19,  18, },
			{ 16,  16,  17,  14,  12,  14,  17,  13,  7,  39,  160,  197,  159,  127,  85,  38,  25,  26,  24,  24,  24,  22,  18,  17,  15,  44,  89,  123,  54,  12,  17,  14, },
			{ 17,  16,  17,  14,  13,  14,  18,  14,  12,  37,  163,  189,  166,  126,  96,  68,  37,  32,  21,  18,  20,  20,  19,  17,  47,  91,  131,  119,  31,  14,  16,  15, },
			{ 18,  13,  17,  13,  12,  17,  18,  15,  7,  52,  163,  173,  168,  134,  89,  79,  66,  48,  18,  19,  26,  39,  37,  51,  102,  123,  168,  90,  10,  15,  19,  14, },
			{ 19,  14,  18,  14,  12,  17,  17,  14,  12,  69,  149,  165,  142,  115,  104,  88,  82,  64,  38,  46,  68,  55,  68,  96,  119,  148,  169,  64,  15,  15,  15,  16, },
			{ 20,  14,  18,  14,  13,  17,  17,  14,  7,  47,  126,  140,  106,  83,  92,  98,  98,  90,  57,  59,  70,  68,  70,  104,  136,  165,  147,  34,  16,  16,  14,  18, },
			{ 20,  14,  18,  14,  13,  18,  17,  14,  12,  43,  108,  101,  89,  92,  86,  87,  104,  101,  78,  82,  83,  95,  77,  113,  155,  170,  113,  22,  14,  17,  15,  17, },
			{ 20,  13,  17,  14,  14,  18,  16,  12,  25,  75,  91,  81,  92,  91,  90,  80,  108,  103,  86,  94,  95,  91,  96,  113,  150,  156,  78,  17,  15,  18,  20,  18, },
			{ 20,  13,  17,  14,  14,  18,  15,  8,  37,  85,  82,  80,  105,  108,  129,  78,  125,  126,  69,  86,  113,  88,  93,  99,  127,  126,  51,  10,  19,  15,  19,  20, },
			{ 19,  13,  16,  14,  15,  19,  14,  6,  45,  82,  55,  82,  126,  104,  115,  149,  165,  136,  99,  136,  108,  73,  80,  77,  112,  96,  32,  12,  20,  16,  17,  20, },
			{ 18,  12,  16,  14,  18,  22,  15,  6,  45,  69,  44,  135,  152,  106,  75,  162,  189,  144,  133,  150,  111,  102,  87,  83,  98,  65,  12,  16,  16,  19,  16,  21, },
			{ 13,  14,  16,  17,  21,  19,  12,  9,  32,  47,  71,  115,  139,  102,  105,  131,  169,  134,  125,  163,  179,  139,  115,  102,  79,  48,  13,  16,  12,  16,  20,  22, },
			{ 16,  15,  15,  14,  19,  22,  15,  9,  27,  75,  100,  102,  134,  125,  97,  87,  140,  128,  115,  168,  131,  73,  99,  97,  71,  58,  11,  5,  12,  18,  16,  20, },
			{ 13,  14,  16,  17,  20,  20,  15,  14,  44,  88,  98,  110,  118,  133,  139,  65,  106,  115,  111,  105,  103,  90,  133,  131,  58,  47,  9,  6,  13,  17,  18,  22, },
			{ 16,  11,  12,  17,  23,  22,  18,  20,  34,  62,  67,  88,  105,  128,  113,  51,  79,  108,  94,  67,  124,  125,  135,  118,  48,  36,  10,  13,  15,  14,  18,  19, },
			{ 11,  9,  14,  17,  20,  18,  15,  18,  43,  43,  81,  104,  114,  136,  111,  57,  59,  99,  70,  54,  138,  132,  117,  81,  41,  31,  10,  12,  16,  16,  15,  16, },
			{ 11,  11,  13,  14,  22,  32,  37,  41,  71,  76,  113,  142,  128,  116,  114,  76,  45,  77,  46,  70,  117,  110,  99,  81,  46,  19,  8,  15,  15,  17,  17,  18, },
			{ 11,  10,  15,  24,  36,  37,  26,  20,  72,  90,  107,  151,  133,  106,  114,  129,  85,  90,  60,  105,  129,  107,  61,  68,  50,  12,  10,  20,  14,  14,  14,  17, },
			{ 13,  13,  22,  31,  32,  23,  19,  27,  77,  110,  81,  145,  145,  120,  130,  196,  125,  83,  160,  112,  90,  96,  68,  39,  35,  12,  13,  15,  16,  17,  12,  20, },
			{ 11,  21,  27,  29,  27,  26,  27,  33,  60,  124,  89,  99,  140,  126,  167,  201,  139,  153,  208,  114,  102,  110,  92,  50,  41,  17,  12,  19,  16,  16,  22,  19, },
			{ 19,  21,  21,  23,  27,  29,  29,  28,  50,  108,  126,  80,  95,  127,  158,  192,  189,  193,  184,  141,  121,  112,  85,  77,  45,  20,  17,  16,  17,  20,  14,  21, },
			{ 14,  15,  15,  20,  27,  32,  29,  23,  39,  80,  126,  118,  100,  125,  180,  202,  219,  190,  143,  110,  98,  86,  104,  87,  36,  27,  19,  17,  18,  17,  17,  21, },
			{ 10,  14,  16,  20,  27,  32,  21,  28,  53,  57,  90,  139,  126,  113,  144,  183,  193,  179,  129,  98,  104,  116,  118,  60,  24,  31,  24,  21,  16,  14,  21,  21, },
			{ 12,  13,  14,  19,  22,  25,  17,  60,  65,  38,  60,  112,  126,  127,  126,  127,  131,  124,  116,  124,  122,  111,  83,  37,  22,  23,  31,  26,  16,  16,  15,  19, },
			{ 13,  10,  11,  20,  20,  17,  21,  86,  80,  35,  54,  94,  112,  124,  135,  116,  104,  104,  120,  109,  90,  73,  58,  36,  22,  18,  25,  29,  22,  15,  16,  16, },
			{ 11,  8,  11,  18,  18,  9,  25,  82,  109,  47,  31,  63,  100,  118,  124,  130,  122,  116,  95,  73,  62,  59,  59,  52,  20,  21,  18,  28,  27,  13,  16,  13, },
			{ 8,  9,  12,  14,  16,  10,  35,  74,  111,  87,  48,  52,  65,  101,  117,  110,  104,  86,  65,  46,  48,  68,  100,  70,  20,  24,  22,  20,  23,  17,  11,  13, },
		},
	},
};


static void net_Task(void *pvParameter) {
    sd_mount(CONFIG_MOUNT_POINT);
    load_ml_net(CONFIG_MOUNT_POINT"/resnet18.ml");
    printf_net_structure(NULL);
    sd_unmount(CONFIG_MOUNT_POINT);
    
    gd.float_buf = malloc(sizeof(float)*2*64*32*32);
    if(gd.float_buf == NULL){
        printf("gd->float_buf malloc error!\n");
    }
    gd.binary_buf = malloc(2*64*32*32/8);
    if(gd.binary_buf == NULL){
        printf("gd->binary_buf malloc error!\n");
    }
    while(1){
        resnet18(get_32x32_jpg(),"0");
        vTaskDelay(1000);
    }
    
}


int16_t data[64*32*32];
void app_main(void)
{
    if(ESP_OK != init_camera()) {
        return;
    }
    // xTaskCreatePinnedToCore(net_Task, "gui", 16384, NULL, 5, NULL, 0);
    gd.dbyte_buf = data;

    gd.binary_buf = malloc(2*64*32*32/8);
    if(gd.binary_buf == NULL){
        printf("gd->binary_buf malloc error!\n");
    }

    sd_mount(CONFIG_MOUNT_POINT);
    load_ml_net(CONFIG_MOUNT_POINT"/resnet18.ml");
    printf_net_structure(NULL);
    sd_unmount(CONFIG_MOUNT_POINT);
    
    gd.float_buf = malloc(sizeof(float)*2*64*32*32);
    if(gd.float_buf == NULL){
        printf("gd->float_buf malloc error!\n");
    }
    while(1){
        data_info_t *input = malloc(sizeof(data_info_t));
        memset(input,0x00,sizeof(data_info_t));
        input->dim[0] = 1;
        input->dim[1] = 3;
        input->dim[2] = 32;
        input->dim[3] = 32;
        input->len = ONE_BYTE;
        input->data = data1;
        
        resnet18(get_32x32_jpg(),"0");
        vTaskDelay(1000);
    }
    
}
